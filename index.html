<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ระบบจองล่าม</title>
</head>
<body>

<h2>ระบบจองล่าม</h2>

<form id="bookingForm">
    <label for="employeeName">ชื่อพนักงาน:</label>
    <input type="text" id="employeeName" required><br>

    <label for="jobDetails">รายละเอียดงาน:</label>
    <textarea id="jobDetails" rows="4" required></textarea><br>

    <label for="interpreter">เลือกล่าม:</label>
    <select id="interpreter" required>
        <option value="">โปรดเลือก</option>
        <option value="SOM SAN">SOM SAN</option>
        <option value="GOOK SAN">GOOK SAN</option>
        <option value="POOKY SAN">POOKY SAN</option>
        <option value="NOEY SAN">NOEY SAN</option>
    </select><br>

    <label for="date">วันที่:</label>
    <input type="date" id="date" required><br>

    <label for="startTime">เวลาเริ่มต้น:</label>
    <select id="startTimeHour" required>
        <option value="">ชั่วโมง</option>
        <!-- Add hour options from 00 to 23 -->
    </select>
    :
    <select id="startTimeMinute" required>
        <option value="00">00</option>
        <option value="30">30</option>
    </select><br>

    <label for="endTime">เวลาสิ้นสุด:</label>
    <select id="endTimeHour" required>
        <option value="">ชั่วโมง</option>
        <!-- Add hour options from 00 to 23 -->
    </select>
    :
    <select id="endTimeMinute" required>
        <option value="00">00</option>
        <option value="30">30</option>
    </select><br>

    <button type="button" onclick="submitForm()">จองล่าม</button>
    <button type="button" onclick="clearForm()">Clear</button>
</form>

<script>
    // Populate hour options
    var hourOptions = '';
    for (var i = 0; i <= 23; i++) {
        hourOptions += '<option value="' + ('0' + i).slice(-2) + '">' + ('0' + i).slice(-2) + '</option>';
    }
    document.getElementById('startTimeHour').innerHTML = hourOptions;
    document.getElementById('endTimeHour').innerHTML = hourOptions;

    function clearForm() {
        document.getElementById('bookingForm').reset();
    }

    function submitForm() {
        var form = document.getElementById('bookingForm');
        var data = {
            employeeName: form.employeeName.value,
            jobDetails: form.jobDetails.value,
            interpreter: form.interpreter.value,
            date: form.date.value,
            startTime: form.startTimeHour.value + ':' + form.startTimeMinute.value,
            endTime: form.endTimeHour.value + ':' + form.endTimeMinute.value
        };

        var xhr = new XMLHttpRequest();
        xhr.open("POST", "https://script.google.com/macros/s/AKfycbyC1Kv25BqZ7H3menZ8tQgdK__CHw4FTjfouda_EZVmIW4LCJKvHRky3isAYT2qaXZJjg/exec", true);
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4 && xhr.status == 200) {
                alert("จองล่ามสำเร็จ");
                clearForm();
            }
        };
        xhr.send(JSON.stringify(data));
    }
</script>

</body>
</html>
