<!DOCTYPE html>
<html>
<head>
    <title>Translator Booking</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            padding: 10px;
        }

        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            max-width: 100%;
            width: 400px;
            box-sizing: border-box;
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        label {
            display: block;
            margin: 15px 0 5px;
            color: #555;
            font-size: 1em;
        }

        input[type="text"], input[type="date"], select {
            width: calc(100% - 20px);
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 1em;
        }

        .time-select {
            display: flex;
            justify-content: space-between;
        }

        .time-select select {
            width: 48%;
        }

        .buttons {
            display: flex;
            justify-content: space-between;
        }

        input[type="button"], input[type="reset"] {
            border: none;
            padding: 10px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 1em;
            margin: 4px 2px;
            cursor: pointer;
            border-radius: 4px;
            width: 48%;
        }

        input[type="button"] {
            background-color: #28a745;
            color: white;
        }

        input[type="button"]:hover {
            background-color: #218838;
        }

        input[type="reset"] {
            background-color: #dc3545;
            color: white;
        }

        input[type="reset"]:hover {
            background-color: #c82333;
        }

        #message {
            margin-top: 20px;
            color: #ff0000;
            text-align: center;
            font-size: 1em;
        }

        /* Loading overlay styles */
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top: 4px solid #000;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Translator Booking</h1>
        <form id="dataForm">
            <label for="bookingBy">Booking By:</label>
            <input type="text" id="bookingBy" name="bookingBy">

            <label for="translatorForWork">Translator for work:</label>
            <input type="text" id="translatorForWork" name="translatorForWork">

            <label for="translatorName">Translator Name:</label>
            <select id="translatorName" name="translatorName">
                <option value="" disabled selected>Select Translator</option>
                <option value="SOM SAN">SOM SAN</option>
                <option value="GOOK SAN">GOOK SAN</option>
                <option value="POOKY SAN">POOKY SAN</option>
                <option value="NOEY SAN">NOEY SAN</option>
            </select>

            <label for="date">Date:</label>
            <input type="date" id="date" name="date">

            <label for="timeFrom">Time From:</label>
            <div class="time-select">
                <select id="timeFromHour" name="timeFromHour">
                    ${generateTimeOptions('hour')}
                </select>
                <select id="timeFromMinute" name="timeFromMinute">
                    ${generateTimeOptions('minute')}
                </select>
            </div>

            <label for="timeTo">Time To:</label>
            <div class="time-select">
                <select id="timeToHour" name="timeToHour">
                    ${generateTimeOptions('hour')}
                </select>
                <select id="timeToMinute" name="timeToMinute">
                    ${generateTimeOptions('minute')}
                </select>
            </div>

            <div class="buttons">
                <input type="button" value="Submit" onclick="submitData()">
                <input type="reset" value="Clear">
            </div>
            
            <p id="message"></p>
        </form>
    </div>

    <!-- Loading overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <script>
        function generateTimeOptions(type) {
            let options = "";
            if (type === 'hour') {
                for (let i = 0; i <= 23; i++) {
                    let value = i.toString().padStart(2, '0');
                    options += `<option value="${value}">${value}</option>`;
                }
            } else if (type === 'minute') {
                options += `<option value="00">00</option>`;
                options += `<option value="30">30</option>`;
            }
            return options;
        }

        function submitData() {
            // Show loading overlay
            document.getElementById("loadingOverlay").classList.add("active");

            var formData = new FormData(document.getElementById("dataForm"));
            var timeFrom = formData.get("timeFromHour") + ":" + formData.get("timeFromMinute");
            var timeTo = formData.get("timeToHour") + ":" + formData.get("timeToMinute");

            formData.set("columnA", new Date().toISOString()); // Adding timestamp
            formData.set("date", formData.get("date").split("-").reverse().join("/")); // Formatting date to dd/mm/yyyy
            formData.set("columnE", timeFrom);
            formData.set("columnF", timeTo);

            fetch("https://script.google.com/macros/s/AKfycbyyq1cgBAtY2vZJqutMNoWv2N_S0NOPxNC9MGh3_QOb1pN9Up1_CRbybARfsGXLNWMP/exec", {
                method: "POST",
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                // Hide loading overlay
                document.getElementById("loadingOverlay").classList.remove("active");

                if (data.success) {
                    alert("ข้อมูลถูกบันทึกเรียบร้อยแล้ว!");
                    document.getElementById("dataForm").reset();
                    document.getElementById("message").innerHTML = "";
                } else {
                    document.getElementById("message").innerHTML = data.message; // แสดงข้อความที่ได้จากการตรวจสอบข้อมูลใน Google Sheets
                }
            })
            .catch(error => {
                // Hide loading overlay
                document.getElementById("loadingOverlay").classList.remove("active");

                console.error("เกิดข้อผิดพลาด:", error);
            });
        }
    </script>
</body>
</html>
